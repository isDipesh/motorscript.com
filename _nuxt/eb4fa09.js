(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{170:function(e,t,n){"use strict";var o={props:["title","published","updated","archived"],head:function(){return{title:this.title}}},r=n(8),component=Object(r.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",{staticClass:"title",attrs:{itemprop:"name headline"}},[e._v(e._s(e.title))]),e._v(" "),n("div",{staticClass:"time"},[e._v("Published: "),n("time",{attrs:{itemprop:"datePublished"}},[e._v(e._s(e.published))])]),e._v(" "),e.updated?n("div",{staticClass:"time"},[e._v("Updated: "),n("time",{attrs:{itemprop:"dateModified"}},[e._v(e._s(e.updated))])]):e._e(),e._v(" "),e.archived?n("div",{staticClass:"block"},[e._v("Note: This is an archived post. Information may not be relevant now.")]):e._e()])}),[],!1,null,null,null);t.a=component.exports},219:function(e,t,n){"use strict";n.r(t);var o=n(170),r={mixins:[o.a],components:{BlogTitle:o.a}},c=n(8),component=Object(c.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("article",{attrs:{itemprop:"blogPost",itemscope:"",itemtype:"https://schema.org/BlogPosting"}},[n("BlogTitle",{attrs:{title:"Security: Hardening SSH on Linux Server",published:"22 Mar 2020"}}),e._v(" "),n("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"content",attrs:{itemprop:"articleBody"}},[e._v("\n      SSH is an essential tool to remotely administrate servers. Although SSH is\n      a very secure protocol, you are prone to brute-force attacks if you don't\n      follow proper security measures. The following instructions can be\n      employed to improve security of a SSH installation on a server with\n      default configuration. It is assumed that the default settings which are\n      secure haven't been already modified.\n\n      "),n("p",[e._v("Warning: Incorrect SSH settings may lock you out of the server.")]),e._v(" "),n("h2",[e._v("Harden SSH Configuration")]),e._v("\n\n      Login to your server and start editing OpenSSH service\n      configuration file:\n\n      "),e._m(0),e._v(" "),n("h3",[e._v("Update the port for SSH service")]),e._v(" "),e._m(1),e._v("\n      Use a port number in the range 1024-49151. Although networking tools can\n      easily detect open ports, this may prevent bots and humans only trying to\n      penetrate on the default port - "),n("i",{staticClass:"hl"},[e._v("22")]),e._v(".\n\n      "),n("h3",[e._v("Use the following HostKey configuration")]),e._v(" "),e._m(2),e._v(" "),n("h3",[e._v("Change default Key Exchange algorithms and Ciphers")]),e._v(" "),e._m(3),e._v("\n      (Recommended by Mozilla)\n\n      "),n("h3",[e._v("Enable Verbose Logging")]),e._v(" "),e._m(4),e._v(" "),n("h3",[e._v("Disable Remote Root Login")]),e._v(" "),e._m(5),e._v(" "),n("h3",[e._v("Only Allow Specific Users to SSH")]),e._v(" "),e._m(6),e._v(" "),n("h3",[e._v("Disable X11Forwarding")]),e._v(" "),e._m(7),e._v("\n      Because you probably don't need GUIs on server.\n\n      "),n("h3",[e._v("Automatically Disconnect Idle Sessions")]),e._v(" "),e._m(8),e._v("\n      SSH sessions will disconnect when no data is received for 5 minutes.\n\n      "),n("h3",[e._v("Disable Password Authentication")]),e._v(" "),e._m(9),e._v("\n      This prevents brute-force login attacks. You will have to use key pair to\n      authenticate.\n\n      "),n("p",[e._v("Confirm if you can make new SSH connections to the server using the current configuration\n      before exiting your current SSH session.")]),e._v(" "),e._m(10),e._v(" "),n("h2",[e._v("Create an included SSH config file")]),e._v("\n       You can also create a separate "),n("span",{staticClass:"hl"},[e._v("conf")]),e._v(" file and include it in your base sshd configuration file "),n("span",{staticClass:"hl"},[e._v("/etc/ssh/sshd_config")]),e._v(". Recent installations are already configured to include all configurations from the directory "),n("span",{staticClass:"hl"},[e._v("/etc/ssh/sshd_config.d/")]),e._v(".\n      "),e._m(11),e._v(" "),e._m(12),e._v(" "),n("h2",[e._v("Generate Private/Public Key Pair")]),e._v("\n\n      On your local computer, generate new SSH key pair. You may want to backup\n      your existing key pairs or create the new pair in a different location.\n      Use a passphrase you can retrieve later while adding this SSH key to your\n      agent.\n      "),e._m(13),e._v("\n\n      Add the new SSH private key to your SSH agent.\n      "),e._m(14),e._v("\n      Use the path you generated the key pairs in.\n\n      "),e._m(15),e._v(" "),e._m(16),e._v("\n\n      You should now be able to securely SSH into the server without using a\n      password.\n\n      "),n("h2",[e._v("Other Security Measures")]),e._v(" "),n("h3",[e._v("Only allow certain sets of IP to SSH")]),e._v("\n      Edit "),n("span",{staticClass:"hl"},[e._v("hosts.allow")]),e._v(" to add allow-list.\n      "),e._m(17),e._v(" "),e._m(18),e._v("\n      You can use single IP address or a range.\n\n      "),n("h3",[e._v("Block certain IP or range of IPs")]),e._v("\n      If brute-force attacks are coming regularly from a certain IP or range,\n      you can block all such incoming connections to your server.\n      "),e._m(19),e._v(" "),e._m(20),e._v(" "),e._m(21),e._v(" "),n("h3",[e._v("Login Banner")]),e._v("\n      A login banner can be used to warn intruders of legal consequences. It can\n      also be used to remind legitimate users of their responsibilities and\n      obligations.\n\n      "),e._m(22),e._v(" "),n("h3",[e._v("Firewall and other tools")]),e._v("\n      A firewall is also a good solution to filter connections for various\n      protocols including SSH. Firewalls and services like "),n("i",{staticClass:"hl"},[e._v("fail2ban")]),e._v(" can be used to block illicit connections to the server.    \n      "),n("p",[n("nuxt-link",{attrs:{to:"/security-hardening-ubuntu-server/"}},[e._v("Refer to this article to view futher tips to harden your server.")])],1)])],1)}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-bash command-line",attrs:{"data-prompt":"#"}},[n("code",[e._v("vi /etc/ssh/sshd_config")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-bash command-line",attrs:{"data-prompt":"$"}},[n("code",[e._v("Port 23456")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-js"},[n("code",[e._v("HostKey /etc/ssh/ssh_host_ed25519_key\nHostKey /etc/ssh/ssh_host_rsa_key\nHostKey /etc/ssh/ssh_host_ecdsa_key")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-js"},[n("code",[e._v("KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-js"},[n("code",[e._v("LogLevel VERBOSE")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-js"},[n("code",[e._v("PermitRootLogin no")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-js"},[n("code",[e._v("AllowUsers "),n("i",[e._v("username1")]),e._v(" "),n("i",[e._v("username2")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-js"},[n("code",[e._v("X11Forwarding no")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-js"},[n("code",[e._v("ClientAliveInterval 300\nClientAliveCountMax 0")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-js"},[n("code",[e._v("PasswordAuthentication no")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n        For older versions of OpenSSH, please refer to this\n        "),n("a",{attrs:{href:"https://infosec.mozilla.org/guidelines/openssh",target:"_blank",rel:"noopener noreferrer"}},[e._v("Mozilla Guideline.")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-bash command-line",attrs:{"data-prompt":"#"}},[n("code",[e._v("vi /etc/ssh/sshd_config.d/add.conf")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-ini code-content"},[n("code",[e._v("#AllowUsers username1 username2\n#Port 23456\nPermitRootLogin no\nX11Forwarding no\n\nHostKey /etc/ssh/ssh_host_ed25519_key\nHostKey /etc/ssh/ssh_host_rsa_key\nHostKey /etc/ssh/ssh_host_ecdsa_key\n\nKexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com\n\nLogLevel VERBOSE\n\nClientAliveInterval 300\nClientAliveCountMax 0\n\nPasswordAuthentication no")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-bash command-line",attrs:{"data-prompt":"$"}},[n("code",[e._v("ssh-keygen -t rsa")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-bash command-line",attrs:{"data-prompt":"$"}},[n("code",[e._v("ssh-add ~/.ssh/id_rsa")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("Copy the contents of "),n("i",{staticClass:"hl"},[e._v("id_rsa.pub")]),e._v(".")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("On the server, paste it to "),n("i",{staticClass:"hl"},[e._v("~/.ssh/authorized_keys")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-bash command-line",attrs:{"data-prompt":"#"}},[n("code",[e._v("vi /etc/hosts.allow")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-js code-content"},[n("code",[e._v("sshd: 192.168.1.5, 94.1.1.1/12, 10.65.140.23/32")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("Edit "),n("span",{staticClass:"hl"},[e._v("hosts.deny")]),e._v(" to add block-list.")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-bash command-line",attrs:{"data-prompt":"#"}},[n("code",[e._v("vi /etc/hosts.deny")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("pre",{staticClass:"language-js code-content"},[n("code",[e._v("sshd: 192.168.1.5, 94.1.1.1/12, 10.65.140.23/32")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("For displaying a message after a user logs in:\n      "),n("pre",{staticClass:"language-bash command-line",attrs:{"data-prompt":"#"}},[n("code",[e._v("vi /etc/motd")])])])}],!1,null,null,null);t.default=component.exports}}]);